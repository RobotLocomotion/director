os:
  - linux
#  - osx

language: generic

virtualenv:
  system_site_packages: true

sudo: required

dist: trusty

notifications:
  email: false

branches:
  only:
    - master

before_install:
  - distro/travis/before_install.sh
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then export DISPLAY=:99.0          ; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then /sbin/start-stop-daemon --start --quiet --pidfile /tmp/custom_xvfb_99.pid --make-pidfile --background --exec /usr/bin/Xvfb -- :99 -ac -screen 0 1280x1024x16  ; fi
#  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sh -e /etc/init.d/xvfb start  ; fi

install: true

script:
  - make superbuild -j2
  - cd build/src/director-build
  - ctest -j 1 -L core --dashboard Experimental --track travis --output-on-failure

after_failure:
  - echo "after_failure pwd: $PWD"

after_success:
  - echo "after_success pwd: $PWD"
#  - cd build/src/director-build
#  - make docs-sphinx-generate
#  - make docs-sphinx-build
#  - distro/package/make_app_bundle.sh
#  - tar -czf DirectorConsole.tar.gz distro/package/DirectorConsole.app
#  - distro/travis/copy_files.sh DirectorConsole.tar.gz
